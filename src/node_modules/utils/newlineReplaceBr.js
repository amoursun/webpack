import {h, c} from 'utils/wrapper/base'
import _ from 'lodash';

const createHtml = encodedHtml => ({
    __html: escape(encodedHtml)
});

function escape(encodedHtml) {
    // 此处后台传输内容保持 textarea 换行/空格格式, 不需要转换成<br/>&nbsp;等
    // _.escape(encodedHtml) 转义XSS指定字符
    return _.escape(encodedHtml).replace(/\r/g, '').replace(/\n/g, '<br/>')
}

export function newlineReplaceBr(input) {
    if (!input) return '';
    return h.span({
        style: {
            display: 'inline-block',
            wordWrap: 'break-word',
            wordBreak: 'break-all',
            paddingLeft: 0,
            width: '100%',
            whiteSpace: 'pre-wrap'
        },
        // dangerouslySetInnerHTML: {
        //     __html: input.replace(/\n|\r|\r\n/g, '<br/>')
        // }
        dangerouslySetInnerHTML: createHtml(input)
    })
    // return h.pre({
    //     style: {
    //         whiteSpace: 'pre-wrap'
    //     }
    // }, input)
}
